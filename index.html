<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StarMaker DreamWork - Multi-Promotion Event Dashboard</title>
    <!-- Load Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind for custom colors and font -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'starmaker-green': '#4CAF50',
                        'starmaker-dark': '#388E3C',
                        'bg-light': '#f8f8f8',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <!-- Custom styling for iframes to ensure they fill the space -->
    <style>
        .iframe-wrapper {
            /* Fixed height for display consistency in the grid */
            height: 400px; 
            box-sizing: border-box;
        }
        iframe {
            /* Ensure iframe takes up all available space within its wrapper */
            width: 100%;
            height: 100%;
            /* Setting pointer-events to none so clicks always hit the wrapper behind the iframe. */
            pointer-events: none; 
        }
    </style>
</head>
<body class="bg-bg-light font-sans min-h-screen flex flex-col">

    <!-- Header Section with Mobile-First Design -->
    <header class="text-center p-4 sm:p-6 bg-starmaker-green text-white shadow-xl">
        <h1 class="text-2xl sm:text-3xl font-bold tracking-tight">StarMaker DreamWork - Cache Reset Attempt</h1>
        <p class="text-sm mt-1 opacity-90 font-semibold">Clicking a card attempts to clear browser storage before redirecting for a 'Fresh' session.</p>
    </header>

    <!-- Main Content Grid: 4 cards on large screens -->
    <div class="container mx-auto p-3 sm:p-5 flex-grow">
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5" id="iframeContainer">
            <!-- iFrames will be injected here by JavaScript -->
        </div>
    </div>

    <!-- Footer Section with SENTERNET TECHNOLOGIES Branding -->
    <footer class="bg-gray-800 text-white p-4 sm:p-6 mt-6 shadow-2xl">
        <div class="container mx-auto text-center">
            <p class="text-lg font-semibold mb-2 text-starmaker-green">A Digital Marketing & Web Design Project by</p>
            <h3 class="text-2xl font-extrabold tracking-wider">SENTERNET TECHNOLOGIES</h3>
            <div class="mt-3 text-sm flex flex-col sm:flex-row justify-center space-y-1 sm:space-y-0 sm:space-x-4">
                <span class="opacity-80">üìç Aranthangi</span>
                <span class="opacity-80">üì± +91 81900 38085</span>
                <span class="opacity-80">üìß senternettechnologies@gmail.com</span>
            </div>
            <p class="mt-4 text-xs opacity-70">Specializing in Website Conversion & Graphic Design.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('iframeContainer');
            // Base URL and fixed parameters
            const baseUrl = "https://m.starmakerstudios.com/a/spa-dreamWorks/index";
            const fixedParams = "&showBar=0&showNavigation=false&new=true&isStatusBarStyle=true"; 
            
            // Custom list of promotion IDs
            const promotionIds = [
                5925, 2711, 65777, 53939, 34448, 49399, 22225, 60223, 69686, 28440, 37838
            ]; 
            
            // --- FUNCTION TO AGGRESSIVELY CLEAR BROWSER STATE (WORKAROUND) ---
            function aggressiveCacheClear() {
                try {
                    // 1. Clear Local Storage for the current domain (the dashboard's domain)
                    localStorage.clear();
                    console.log('Local Storage cleared successfully.');

                    // 2. Aggressively clear cookies for the current domain
                    document.cookie.split(";").forEach((c) => {
                        document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/");
                    });
                    console.log('Cookies cleared successfully.');
                    
                    // 3. Optional: Clear Session Storage
                    sessionStorage.clear();
                    console.log('Session Storage cleared successfully.');
                    
                } catch (e) {
                    console.error('Error attempting to clear browser storage:', e);
                }
                
                // Note: This only clears the *dashboard's* browser data. It cannot clear the StarMaker *app's* internal cache.
            }

            promotionIds.forEach((promotionId, index) => {
                const dreamWorkNumber = index + 1;
                const fullUrl = `${baseUrl}?promotion_id=${promotionId}${fixedParams}`;

                // Create wrapper with Tailwind styling and make it look clickable
                const wrapper = document.createElement('div');
                wrapper.className = 'iframe-wrapper bg-white rounded-xl shadow-lg hover:shadow-xl hover:ring-4 hover:ring-starmaker-dark transition duration-300 p-2 flex flex-col border border-gray-200 cursor-pointer';

                // Store the full URL in a data attribute
                wrapper.dataset.url = fullUrl;

                // Add click event listener to the entire card
                wrapper.addEventListener('click', function() {
                    const urlToRedirect = this.dataset.url;
                    
                    // CALL THE AGGRESSIVE RESET FUNCTION HERE
                    aggressiveCacheClear(); 
                    
                    // Redirects the current window/tab (the main running app) to the iframe's source URL
                    window.location.href = urlToRedirect; 
                });


                // Display the new Title format: DreamWork X - Promotion ID: YYYY
                const title = document.createElement('div');
                title.className = 'iframe-title text-center text-base font-extrabold text-starmaker-dark p-1 mb-1 border-b-2 border-starmaker-green/50';
                title.textContent = `DreamWork ${dreamWorkNumber} - Promotion ID: ${promotionId}`;
                wrapper.appendChild(title);

                // Create iframe element (for preview)
                const iframe = document.createElement('iframe');
                iframe.setAttribute('src', fullUrl);
                iframe.setAttribute('loading', 'lazy'); 
                iframe.setAttribute('title', `Promotion Dashboard ${promotionId}`);
                iframe.setAttribute('sandbox', 'allow-same-origin allow-popups allow-forms'); 
                wrapper.appendChild(iframe);

                container.appendChild(wrapper);
            });
        });
    </script>

</body>
</html>

